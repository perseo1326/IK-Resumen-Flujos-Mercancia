<!DOCTYPE html><html lang=es><head><meta charset=UTF-8 /><meta name=viewport content="width=device-width, initial-scale=1.0" /><meta name=autor content=https://github.com/perseo1326 /><title>Resumen Flujos Mercancia</title><style>*{--background:white;--first-color:#0057a4;--second-color:#ffdb01;--warning-color:rgba(255,165,0,1);--height-title:13%;--height-data:87%;--height-total:100%;--A4-width:21cm;--A4-height:29.7cm;margin:0;padding:0;box-sizing:border-box;font-family:"Noto IKEA","Noto Sans","Roboto","Open Sans",system-ui,sans-serif;font-size:16px}.no-visible{display:none}.show-print{display:none}.centrar{text-align:center}.align-left{text-align:left}.bold{font-weight:bold}.block{display:block}.margen-bajo-05{margin-bottom:.5em}.back-1{background-color:var(--first-color);color:var(--second-color)}html,body.box{height:var(--height-total)}div.container-title{height:var(--height-title);display:flex;flex-direction:column}div.title{padding:.5em;width:100%}div.container-title div.find-box{display:flex;justify-content:flex-end}div.container-title div.find-box div.find{display:flex;align-items:center;margin-right:2em;border:1px dotted transparent;cursor:pointer}div.container-title div.find-box div.find:hover{border:1px solid var(--first-color);border-radius:3px;background-color:var(--second-color)}div.container-title div.find-box div.find p{padding:0 .5em;color:var(--first-color);font-size:1.2em}div.container-title div.find-box div.find span svg{fill:var(--first-color);padding:.2em .3em}div.start-panel{background-color:#add8e6;height:var(--height-data)}div.contenido{height:var(--height-total);display:flex;flex-direction:column;justify-content:center;align-items:center}h1{text-align:center;font-size:2em}label{padding:.3em;font-size:1.2em}.custom-button{border:1px solid var(--first-color);border-radius:4px;background-color:var(--first-color);color:var(--second-color);cursor:pointer;font-size:1rem;margin:.3rem auto;padding:.3rem .6rem;text-align:center}.custom-button:hover{background-color:var(--second-color);color:var(--first-color);border:1px solid var(--first-color)}div.go-button{display:flex;padding:0 2em;flex-direction:column;justify-content:center;cursor:pointer;border:1px solid transparent;border-radius:4px}div.go-button:hover{background-color:var(--first-color);border:1px solid var(--first-color);border-radius:4px}div.go-button svg{fill:var(--first-color)}div.go-button:hover svg{fill:var(--second-color)}div.loading-frame{position:absolute;top:0;left:0;width:100%;height:100%;backdrop-filter:blur(5px);z-index:10}div.loading-frame div.loading{position:relative;background-color:var(--first-color);color:var(--second-color);text-align:center;max-width:40%;margin:auto;top:50%;padding:2rem;border-radius:5px;transform:translate(-0,-50%);-webkit-transform:translate(-0,-50%)}div.loading p{margin:auto;font-weight:bold;font-size:1.5em}div.container-find{display:flex;background-color:rgba(173,255,47,.5);width:100%;height:100%;align-items:center;justify-content:center}div.find-title{border-top-left-radius:5px;border-top-right-radius:5px;background-color:var(--second-color);color:var(--first-color)}div.find-title h3{font-size:1.5em;text-align:center;padding:.5em .8em}div.find-content{display:flex;flex-direction:column;background-color:var(--background);border-radius:5px}div.find-content div.find-text{padding:.5em;margin:auto}div.find-content div.find-text input{text-align:center;outline:0;padding:.3em}div.find-content div.find-text input:focus{border:2px solid var(--first-color);border-radius:4px;box-shadow:0 4px 8px 0 rgba(0,0,0,.2),0 6px 20px 0 rgba(0,0,0,.19)}div.find-content div.find-text input.error{border-radius:4px;border:2px solid #f00}div.find-content div.find-buttons{display:flex;flex-direction:row;padding:.5em}div.find-content div.find-selection{display:flex;flex-direction:row;justify-content:center;padding:.5em 0}div.find-content div.find-selection input[type="radio"]{-webkit-appearance:none;appearance:none}div.find-content div.find-selection label{display:flex;flex-direction:row-reverse;justify-content:center;text-align:center;width:40%}div.find-content div.find-selection label p{padding:0 0 0 .3em;line-height:1.5em;display:inline-block}div.find-content div.find-selection label span{border:3px solid var(--first-color);width:1.5em;height:1.5em;display:inline-block;border-radius:50%;background-color:var(--background)}div.find-content div.find-selection label input:checked+span{border:3px solid var(--first-color);background-color:var(--first-color);padding:.5em}div.find-content div.find-error{color:#f00;text-align:center;padding:.3em .5em}div.found-items{background-color:var(--background);padding:.5em;width:auto;max-height:20em;overflow-y:auto;border-top:2px solid var(--first-color)}div.found-items table{border:2px solid transparent}div.found-items tbody#found-items-content tr{border-bottom:1px solid transparent;cursor:pointer}div.found-items tbody#found-items-content tr:hover{background-color:var(--second-color);border-bottom:1px solid #808080}div.found-items tbody#found-items-content tr td{padding:.2em}div.found-items tbody#found-items-content tr td svg{fill:var(--first-color);display:block;height:1em;width:1em;transform:rotate(180deg);margin:auto}div.found-items tbody#found-items-content tr td.found-item-icon:hover{padding:0;cursor:pointer}div.found-items tbody#found-items-content tr td.found-item-icon:hover svg{height:1.5em;width:1.4em}div.found-item-details{top:50%;left:50%;height:75%;width:60%;z-index:15;position:fixed;padding:.5em;transform:translate(-50%,-50%);background-color:var(--background)}div.close-icon{top:1em;right:2em;position:absolute;z-index:20}div.close-icon svg{fill:var(--warning-color);height:1.5em;display:block}div.close-icon:hover svg{fill:var(--second-color)}div.container-find div.found-item-details div.found-item-details-panel-table{height:100%;overflow-y:scroll}div.container-find div.found-item-details table{height:100%}div.found-item-details div.found-item-details-panel-table tbody#found-item-details-data tr td.header{padding:.2em}tbody#found-item-details-data tr.orders:hover{background-color:var(--second-color)}tbody#found-item-details-data tr td.link{text-decoration:underline var(--first-color) solid;color:var(--first-color);cursor:pointer;padding:0 .2em}tbody#found-item-details-data tr td.link:hover{color:var(--background);text-decoration-color:var(--background)}table tbody#table-body tr.main-type td svg{fill:var(--first-color);position:relative;transform:rotate(180deg);height:2em;width:auto}table tbody#table-body tr.main-type td:hover svg{fill:var(--background);transform:rotate(270deg)}table tbody#table-body tr.main-type div.expand-base{position:relative}table tbody#table-body tr.main-type div.expand-base div.expand-cover{position:absolute;width:100%;height:100%;z-index:5}table{width:100%;min-height:var(--height-data);border-collapse:collapse;border:2px solid #000}table tr th{border-bottom:2px solid #000;background-color:var(--first-color);color:var(--second-color);padding:.3em}table tbody#table-body tr:hover{background-color:var(--second-color)}table tbody#table-body tr{border-bottom:1px solid #808080}table tbody#table-body tr td{padding:.3em}table tbody#table-body tr td.isell{color:var(--first-color)}table tbody#table-body tr.main-type{background-color:var(--second-color);font-weight:bold}table tbody#table-body tr.main-type td.expand{cursor:pointer}table tbody#table-body tr.totals{font-weight:bold}table tbody#table-body tr.row{background-color:#d3d3d3}table tbody#table-body tr.hide-details{display:none}div.footer-version{padding:.2em 1em}div.footer-version p.version{text-align:right;font-style:italic;font-size:.8em}div.print-box{display:flex;padding:.5em;width:100%}@media print{*,*:after,*:before{--background:transparent;--first-color:#000;--second-color:#fff}body,html{background-color:transparent !important;color:#000 !important;padding:0}div.container-title{height:calc(var(--height-title)/2)}table tr th{print-color-adjust:exact;-webkit-print-color-adjust:exact;background-color:#aaa7a7;color:var(--first-color)}.hide-print{display:none !important}table tbody#table-body tr.main-type,table tbody#table-body tr.totals{print-color-adjust:exact;-webkit-print-color-adjust:exact;background-color:#d3d3d3}}</style></head><body class=box><div class="loading-frame no-visible" id=loading-frame><div class=loading><p id=loading>Cargando...</p></div></div><div id=finding-frame class="loading-frame no-visible"><div class=container-find><div id=found-item-details class="no-visible found-item-details"><div id=found-item-details-close class=close-icon><svg xmlns=http://www.w3.org/2000/svg height=1em viewBox="0 0 512 512"><path d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c-9.4 9.4-9.4 24.6 0 33.9l47 47-47 47c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l47-47 47 47c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-47-47 47-47c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-47 47-47-47c-9.4-9.4-24.6-9.4-33.9 0z" /></svg></div><div class=found-item-details-panel-table><table><tbody id=found-item-details-data></tbody></table></div><div class=found-item-reference-panel-table><table><tbody id=found-item-reference-details-data></tbody></table></div></div><div class=finding-box><div class=find-title><h3>Buscar por ISELL o por Referencia</h3></div><div class=find-content><div class=find-text><input id=finding-text type=text name=finding-text /></div><div class=find-selection><label for=find-isell><p>Isell</p><input type=radio name=find-type id=find-isell value=ISELL checked /><span></span></label><div><span></span></div><label for=find-ref><p>Referencia</p><input type=radio name=find-type id=find-ref value=REFERENCE /><span></span></label></div><div id=find-error class="no-visible find-error"></div><div class=find-buttons><input id=find-submit-b class=custom-button type=submit value=Buscar /><input id=find-cancel-b class=custom-button type=button value=Salir /></div></div><div id=found-items class="no-visible found-items"><table><tbody id=found-items-content></tbody></table></div></div></div></div><div class=container-title><div class=title><h1 id=title>Pedidos por flujos</h1></div><div id=find-box class="find-box hide-print"><div id=find-button class=find><p>Buscar</p><span><svg xmlns=http://www.w3.org/2000/svg height=2em viewBox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" /></svg></span></div></div></div><div id=start-panel class="start-panel hide-print"><div class=contenido><div class=margen-bajo-05><label id=load-file-label class="block custom-button" for=load-file>Cargar Reporte...</label><input id=load-file type=file class=no-visible /></div><div class=margen-bajo-05><input class="block custom-button" type=date name="" id=work-date /></div><div id=go-button class=go-button><svg xmlns=http://www.w3.org/2000/svg height=2em viewBox="0 0 384 512"><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z" /></svg></div></div></div><div id=data-panel class="data no-visible"><table><thead><tr class=centrar><th>Tipo de Flujo</th><th>COTs</th><th>Isells</th><th>Market</th><th>Autoservicio</th><th>Full</th><th>Total por flujo</th></tr></thead><tbody id=table-body></tbody></table><div class="footer-version margen-bajo-05"><p id=version-footer class="version _ancho-50">(https://github.com/perseo1326)</p></div><div class="print-box hide-print"><button id=print-button class=custom-button>Imprimir Información</button></div></div><script src=https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js></script><script>"use strict";function validateContentExcel(n){return n===undefined||n.length<=0?!1:n[0][R]===undefined||n[0][y]===undefined||n[0][O]===undefined||n[n.length-1][g]===undefined||n[n.length-1][h]===undefined?!1:!0}function filterOrdersByDate(n,t){return n.filter(n=>n[O].trim()===t)}function readReportsExcel(n,t){let i=t;if(n===undefined||!n.name.toLowerCase().endsWith(".xlsx")&&n.type!==j){console.log('ERROR:readReportsExcel: El archivo "'+n.name+'" NO es válido.');throw new Error('El archivo "'+n.name+'" NO es válido.');}if(!validateContentExcel(i)){console.log("ERROR:readReportsExcel: Contenido del archivo NO válido.");throw new Error("Contenido del archivo NO válido.");}return i}function mappingArrayDataExcel(n){let t=new Map;return n.forEach(n=>{if(!t.has(n[h])){let i=new Order(n);t.set(n[h],i)}let r=new Product(n),i=t.get(n[h]);i.o(r,n[y]);t.set(n[h],i)}),t}function initializePage(){console.log("Inicializando valores originales...");o.innerText="Cargar Reporte...";a.classList.add("no-visible");document.title=d.innerText="Pedidos por flujos";i.style.display="none";s.value="";f.innerText="Versión "+U+f.innerText;F=[];x=new Map;B=new Map;L=new Map;r.valueAsDate=new Date}function validateDate(n){const t=n.valueAsDate;if(!t){console.log("WARNING:validateDate: La fecha seleccionada es inválida.");throw new Error("La fecha seleccionada es inválida.");}return n.value}function openFile(n){try{let i=n.target.files[0];a.classList.remove("no-visible");let t=new ExcelFileOpen(i);o.innerText=t.file.name;loadReportsExcel(t)}catch(t){console.log("ERROR:openFile: ",t);alert(t.message);initializePage()}}function loadReportsExcel(n){let t=new FileReader;const i="read",r="utils",u="sheet_to_row_object_array",f="Sheets";t.onloadend=()=>{a.classList.add("no-visible")};t.readAsArrayBuffer(n.file);t.onload=function(){try{let e=this.result,o=XLSX[i](e),s=XLSX[r][u](o[f][V]),t=readReportsExcel(n.file,s);console.log('Carga "'+n.file.name+'" Finalizada!',t);F=t}catch(t){console.log("ERROR:",t);alert(t.message);initializePage()}}}function createReferencesMap(n){const t=new Map;return n.forEach(n=>{t.has(n[m])||t.set(n[m],{[m]:n[m],[w]:n[w],O:[]});let i={[h]:n[h],[R]:n[R],[g]:n[g]};t.get(n[m]).O.push(i)}),t}function proccesData(){try{const u=validateDate(r);if(F===undefined||F<=0){console.log("WARNING:proccesData: No se ha seleccionado un archivo de datos válido.");throw new Error("No se ha seleccionado un archivo de datos válido.");}F=filterOrdersByDate(F,u);L=createReferencesMap(F);x=mappingArrayDataExcel(F);x.forEach(n=>{if(!B.has(n[R]+","+n[g])){let t=new OrderType(n[R],n[g]);B.set(n[R]+","+n[g],t)}let t=B.get(n[R]+","+n[g]);t.h(n);B.set(n[R]+","+n[g],t)});let t=[];B.forEach((n,i)=>{t.push(i)});let n=new Map;t.sort().forEach(t=>{let u=B.get(t),i=t.split(",");n.has(i[0])||n.set(i[0],{g:i[0],D:new Set,N:0,T:0,F:0,L:0});let r=n.get(i[0]);r.N+=u[D];r.T+=u[N];r.F+=u[T];r.L+=u.u.length;r.D.add(i[1]);n.set(i[0],r)});console.log("Totales por flujo: ",n);k.classList.add("no-visible");P.classList.remove("no-visible");i.style.display="flex";showContent(n,B);document.title=d.innerText=d.innerText+" ("+r.value+")"}catch(n){console.log("ERROR:proccesData: ",n);alert(n.message);initializePage()}}function printDocument(){console.log("Printing Document...");const nx=document.getElementsByClassName("details");for(const n of nx)n.classList.remove("hide-details");window.print()}function reverseRowVisibility(n,t){n.id===t&&(n.classList.toggle("hide-details"),reverseRowVisibility(n.nextSibling,t))}function validateIsellRef(n){if(n===""){console.log("WARNING:validateIsellRef: No hay datos que buscar.");throw new Error("No hay datos que buscar.");}if(/[^0-9]/.test(n)){console.log("WARNING:validateIsellRef: Unicamente se permiten números.");throw new Error("Unicamente se permiten números.");}return n}function findByIsell(n,t){const i=new Map;return t.forEach((t,r)=>{r.includes(n)&&i.set(r,t)}),i}function findByReference(n,t){const i=new Map;return t.forEach((t,r)=>{r.includes(n)&&i.set(r,t)}),i}function searchErrorResults(n){if(n.size<=0){console.log("INFO:searchErrorResults: No hay resultados para la búsqueda.");throw new Error("No hay resultados para la búsqueda.");}if(n.size>15){console.log("INFO:searchErrorResults: Búsqueda con demasiados resultados = "+n.size);throw new Error("Búsqueda con demasiados resultados: "+n.size);}}function findIsellRef(){try{document.getElementById("find-error").innerText="";document.getElementById("find-error").classList.add("no-visible");s.classList.remove("error");const i=validateIsellRef(s.value),r=document.querySelector("input[name='find-type']:checked").value;let n=undefined,t="";switch(r){case q:n=findByIsell(i,x);searchErrorResults(n);t=drawFindByIsellItems(n);break;case G:n=findByReference(i,L);searchErrorResults(n);t=drawFindByReferenceItems(n);break;default:return}previsualizeFoundItems(t)}catch(n){document.getElementById("find-error").innerText=n.message;document.getElementById("find-error").classList.remove("no-visible");s.classList.add("error");console.log("ERROR:",n)}}function previsualizeFoundItems(t){e.classList.remove("no-visible");n.innerHTML="";n.innerHTML=t===""?"<tr><td>No se encontraron coincidencias.<\/td><\/tr>":t}function drawFindByIsellItems(n){let t="";return t+="<tr>",t+="<th>",t+="ISELL",t+="<\/th>",t+="<th>",t+="Tipo de Flujo",t+="<\/th>",t+="<th>",t+="COT",t+="<\/th>",t+="<th>",t+=" ",t+="<\/th>",t+="<\/tr>",n.forEach(n=>{t+=drawItemByIsell(n)}),t}function drawItemByIsell(n){let t="";return t+="<tr>",t+="<td>",t+=n[h],t+="<\/td>",t+="<td>",t+=n[R],t+="<\/td>",t+="<td>",t+=n[g],t+="<\/td>",t+="<td id='",t+=n[h],t+="' class='found-item-icon'",t+=" onclick='javascript:foundItemByIsellShowDetails(\"",t+=n[h],t+="\")' >",t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">',t+='<path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/>',t+="<\/svg>",t+="<\/td>",t+"<\/tr>"}function drawOrderProductsDetails(n){let t="";return n.forEach(n=>{t+="<tr>",t+="<td class='centrar'>",t+=n[m],t+="<\/td>",t+="<td>",t+=n[w],t+="<\/td>",t+="<td class='centrar'>",t+=n[I],t+="<\/td>",t+="<\/tr>"}),t}function foundItemByIsellShowDetails(n){document.getElementById("found-item-details").classList.remove("no-visible");const i=x.get(n);let t="";t+="<tr>";t+="<td class='header'>ISELL: <\/td>";t+="<td class='bold header' >";t+=i[h];t+="<\/td>";t+="<\/tr>";t+="<tr>";t+="<td class='header'>CUT OFF DATE: <\/td>";t+="<td class='header'>";t+=r.value;t+="<\/td>";t+="<\/tr>";t+="<tr>";t+="<td class='header'>CUT OFF TIME: <\/td>";t+="<td class='header'>";t+=i[g];t+="<\/td>";t+="<\/tr>";t+="<tr>";t+="<td class='header'>Tipo de Flujo: <\/td>";t+="<td class='header'>";t+=i[R];t+="<\/td>";t+="<\/tr>";t+="<tr><td colspan='3' class='centrar back-1 bold' >";t+="Market";t+="<\/td><\/tr>";t+=drawOrderProductsDetails(i.R.get(D));t+="<tr><td colspan='3' class='centrar back-1 bold' >";t+="Auto Servicio";t+="<\/td><\/tr>";t+=drawOrderProductsDetails(i.R.get(N));t+="<tr><td colspan='3' class='centrar back-1 bold' >";t+="Full - Almacén";t+="<\/td><\/tr>";t+=drawOrderProductsDetails(i.R.get(T));t+="<tr class='centrar back-1 bold'>";t+="<td>Paquetes<\/td>";t+="<td>Peso<\/td>";t+="<td>Volumen<\/td>";t+="<\/tr>";t+="<tr>";t+="<td class='centrar' >";t+=i.p;t+="<\/td>";t+="<td class='centrar' >";t+=i.I;t+="<\/td>";t+="<td class='centrar' >";t+=i.v;t+="<\/td>";t+="<\/tr>";l.innerHTML=t}function drawFindByReferenceItems(n){let t="";return t+="<tr>",t+="<th>",t+="Referencia",t+="<\/th>",t+="<th>",t+="Producto",t+="<\/th>",t+="<th>",t+="Pedidos",t+="<\/th>",t+="<\/tr>",n.forEach(n=>{t+=drawItemByReference(n)}),t}function drawItemByReference(n){let t="";return t+="<tr>",t+="<td>",t+=n[m],t+="<\/td>",t+="<td>",t+=n[w],t+="<\/td>",t+="<td class='centrar found-item-icon'",t+=" onclick='javascript:foundItemByReferenceShowIsells(\"",t+=n[m],t+="\")' >",t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">',t+='<path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/>',t+="<\/svg>",t+="<\/td>",t+"<\/tr>"}function foundItemByReferenceShowIsells(n){document.getElementById("found-item-details").classList.remove("no-visible");const i=L.get(n);let t="";t+="<tr>";t+="<td class='header'>Referencia: <\/td>";t+="<td class='bold header' >";t+=i[m];t+="<\/td>";t+="<\/tr>";t+="<tr>";t+="<td class='header'>Articulo: <\/td>";t+="<td class='header'>";t+=i[w];t+="<\/td>";t+="<\/tr>";t+="<tr><td colspan='3' class='centrar back-1 bold' >";t+="Listado de Pedidos";t+="<\/td><\/tr>";t+=drawReferenceBelongsToOrders(i.O);l.innerHTML=t}function drawReferenceBelongsToOrders(n){let t="";return n.forEach(n=>{t+="<tr class='orders'>",t+="<td class='link centrar bold' onclick='javascript:foundItemByIsellShowDetails(\"",t+=n[h],t+="\")' >",t+=n[h],t+="<\/td>",t+="<td>",t+=n[R],t+="<\/td>",t+="<td>",t+=n[g],t+="<\/td>",t+="<\/tr>"}),t}function showRowDetails(n){const t=n.target;if(t.classList.contains("expand-cover")){const n=t.parentElement.parentElement.parentElement;reverseRowVisibility(n.nextSibling,n.id)}}function showContent(n){c.innerHTML="";let t="";n.forEach((n,i)=>{t+=drawMainRow(n,i)});let i=0,r=0,u=0;n.forEach(n=>{i+=n.N,r+=n.T,u+=n.F});t+=showTotals(i,r,u);c.innerHTML+=t}function drawMainRow(n,t){let i="";i+="<tr id='"+t+"' class='centrar main-type'>";i+="<td class='align-left'>";i+=t;i+="<\/td>";i+="<td class='expand'>";i+="<div class='expand-base'>";i+="<div class='expand-cover'>";i+="<\/div>";i+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">';i+='<path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/>';i+="<\/svg>";i+="<\/div>";i+="<\/td>";i+="<td class='isell'>";i+=n.L;i+="<\/td>";i+="<td>";i+=n.N;i+="<\/td>";i+="<td>";i+=n.T;i+="<\/td>";i+="<td>";i+=n.F;i+="<\/td>";i+="<td>";i+=n.N+n.T+n.F;i+="<\/td>";i+="<\/tr>";let r=!0;return n.D.forEach(n=>{i+=showDetailRow(t,n,B.get(t+","+n),r),r=!r}),i}function showDetailRow(n,t,i,r){let u="";return u+="<tr id='"+n+"' class='centrar details hide-details "+(r?"row":"")+"'>",u+="<td>",u+="",u+="<\/td>",u+="<td>",u+=t,u+="<\/td>",u+="<td>",u+="",u+="<\/td>",u+="<td>",u+=i[D],u+="<\/td>",u+="<td>",u+=i[N],u+="<\/td>",u+="<td>",u+=i[T],u+="<\/td>",u+="<td>",u+=i[D]+i[N]+i[T],u+="<\/td>",u+"<\/tr>"}function showTotals(n,t,i){let r="";return r+="<tr class='centrar totals'>",r+="<td colspan='2'>",r+="TOTALES",r+="<\/td>",r+="<td class='isell'>",r+=x.size,r+="<\/td>",r+="<td>",r+=n,r+="<\/td>",r+="<td>",r+=t,r+="<\/td>",r+="<td>",r+=i,r+="<\/td>",r+="<td>",r+=n+t+i,r+="<\/td>",r+"<\/tr>"}class ExcelFileOpen{constructor(n){if(!n){console.log("ERROR:ExcelFileOpen: No se ha seleccionado ningun archivo.");throw new Error("No se ha seleccionado ningun archivo.");}this.file=n;this.t=""}}"use strict";class OrderType{constructor(n,t){this.i=n.trim();this.l=t.trim();this[D]=0;this[N]=0;this[T]=0;this.u=[]}h(n){n.m(D)&&this[D]++;n.m(N)&&this[N]++;n.m(T)&&this[T]++;this.u.push(n[h])}}class Order{constructor(n){this[h]=n[h].trim();this[R]=n[R].trim();this[g]=n[g].trim();this.R=new Map([[D,[]],[N,[]],[T,[]]]);this.p=0;this.v=0;this.I=0}o(n,t){this.R.get(t).push(n)}m(n){let t=this;return t.R.get(n).length<1?!1:!0}}class Product{constructor(n){this[w]=n[w].trim();this[m]=n[m].trim();this[p]=Number(n[p].trim());this[E]=Number(n[E].trim());this[v]=Number(n[v].trim());this[I]=Number(n[I].trim());this[b]=Number(n[b].trim())}}const M=document.getElementById("load-file"),o=document.getElementById("load-file-label"),r=document.getElementById("work-date"),A=document.getElementById("go-button"),a=document.getElementById("loading-frame"),k=document.getElementById("start-panel"),P=document.getElementById("data-panel"),c=document.getElementById("table-body"),S=document.getElementById("print-button"),d=document.getElementById("title"),i=document.getElementById("find-box"),C=document.getElementById("find-button"),e=document.getElementById("found-items"),t=document.getElementById("finding-frame"),s=document.getElementById("finding-text"),_=document.getElementById("find-cancel-b"),z=document.getElementById("find-submit-b"),n=document.getElementById("found-items-content"),l=document.getElementById("found-item-details-data"),u=document.getElementById("found-item-details-close"),f=document.getElementById("version-footer"),U="1.1",j="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",h="ISELL_ORDER_NUMBER",w="ARTICLE_NAME",m="ARTICLE_NUMBER",R="ORDER_TYPE",p="PACKAGES",E="WEIGHT",v="VOLUME_ORDERED",b="ARTICLES",I="ORDERED_QTY",y="PICK_AREA",O="CUT_OFF_DATE",g="CUT_OFF_TIME",V="DATA",D="MARKETHALL",N="SELFSERVE",T="FULLSERVE_INTERNAL",q="ISELL",G="REFERENCE";let F=[],L=new Map,x=new Map,B=new Map;M.addEventListener("change",openFile);A.addEventListener("click",proccesData);c.addEventListener("click",showRowDetails);S.addEventListener("click",printDocument);C.addEventListener("click",function(){t.classList.remove("no-visible");s.value="";n.innerHTML=""});_.addEventListener("click",()=>{s.value="",s.classList.remove("error"),document.getElementById("find-error").classList.add("no-visible"),t.classList.add("no-visible"),n.innerHTML="",e.classList.add("no-visible")});z.addEventListener("click",findIsellRef);u.addEventListener("click",()=>{u.parentElement.classList.add("no-visible")});initializePage()</script></body></html>